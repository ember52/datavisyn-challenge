graph TD
    A["1. Provision Cluster<br/>Ansible OR Terraform"] --> B["2. Install MetalLB<br/>local only"]
    A --> C["3. Apply StorageClass<br/>NFS or GP3"]
    B --> D["4. Install NGINX Ingress Controller"]
    C --> D
    D --> E["5. Create Wildcard TLS Certificate<br/>+ Default SSL Secret"]
    E --> F["6. Deploy Keycloak via Helm"]
    F --> G["7. Configure Keycloak<br/>Realm, Clients, Users"]
    G --> H["8. Deploy ArgoCD via Helm<br/>+ SOPS Age Key Secret"]
    H --> I["9. Apply ArgoCD Application<br/>modern-webapp"]
    I --> J["10. ArgoCD Deploys<br/>Webapp + OAuth2 Proxy"]

    style A fill:#e67e22,color:#fff
    style F fill:#9b59b6,color:#fff
    style H fill:#e74c3c,color:#fff
    style J fill:#2ecc71,color:#fff
    style E fill:#3498db,color:#fff
